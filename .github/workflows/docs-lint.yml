# Documentation Lint Workflow
# Runs kttc lint on documentation files before publishing
# "Heal thyself before healing others"

name: Docs Lint

on:
  push:
    branches: [main]
    paths:
      - 'docs/**/*.md'
      - '*.md'
  pull_request:
    branches: [main]
    paths:
      - 'docs/**/*.md'
      - '*.md'

jobs:
  lint-docs:
    runs-on: ubuntu-latest
    name: Lint Documentation

    steps:
      - uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'

      - name: Install KTTC
        run: |
          pip install -e ".[dev]"

      - name: Lint Russian Documentation
        if: always()
        run: |
          echo "ğŸ” Checking Russian documentation..."
          for file in $(find docs -name "*.md" -path "**/ru/*" 2>/dev/null || echo ""); do
            if [ -f "$file" ]; then
              echo "Checking $file..."
              python3.11 -m kttc lint "$file" --lang ru || true
            fi
          done

      - name: Lint English Documentation
        if: always()
        run: |
          echo "ğŸ” Checking English documentation..."
          for file in README.md CONTRIBUTING.md docs/*.md; do
            if [ -f "$file" ]; then
              echo "Checking $file..."
              python3.11 -m kttc lint "$file" --lang en || true
            fi
          done

      - name: Summary
        if: always()
        run: |
          echo ""
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          echo "ğŸ“ Documentation lint completed"
          echo "   Review warnings above before publishing"
          echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
          echo ""
          echo "ğŸ’¡ Pro tip: Run 'kttc proofread <file> --lang <lang>' locally"
          echo "   before committing documentation changes."
