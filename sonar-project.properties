# SonarCloud Project Configuration
# https://docs.sonarsource.com/sonarcloud/advanced-setup/languages/python/
# Updated: November 2025

# =============================================================================
# Project Identification
# =============================================================================
sonar.projectKey=kttc-ai_kttc
sonar.organization=kttc-ai
sonar.projectName=KTTC
sonar.projectVersion=0.4.2

# =============================================================================
# Source Code Configuration
# =============================================================================
sonar.sources=src/
sonar.tests=tests/
sonar.sourceEncoding=UTF-8

# =============================================================================
# Python Configuration (2025 Best Practices)
# =============================================================================
# Specify supported Python versions for precise analysis
# See: https://docs.sonarsource.com/sonarcloud/advanced-setup/languages/python/
sonar.python.version=3.11,3.12,3.13

# Coverage report (generated by pytest-cov)
sonar.python.coverage.reportPaths=coverage.xml

# External analyzer reports (generated in CI)
# See: https://docs.sonarcloud.io/enriching/external-analyzer-reports/
sonar.python.mypy.reportPaths=mypy-report.txt
sonar.python.pylint.reportPaths=pylint-report.txt
sonar.python.bandit.reportPaths=bandit-report.json
sonar.python.ruff.reportPaths=ruff-report.txt

# =============================================================================
# Performance Optimization (2025)
# =============================================================================
# Enable analysis caching for faster subsequent scans
sonar.analysisCache.enabled=true

# Parallel analysis threads (default: 90% of cores, max 6)
# Uncomment to customize: sonar.python.analysis.threads=4

# =============================================================================
# Exclusions (aligned with DeepSource and .gitignore)
# =============================================================================
sonar.exclusions=\
  examples/**,\
  scripts/**,\
  docs/**,\
  **/migrations/**,\
  **/__pycache__/**,\
  .venv/**,\
  venv/**,\
  build/**,\
  dist/**,\
  *.egg-info/**,\
  **/*.pyc,\
  **/*.pyo

# Test file patterns
sonar.test.inclusions=\
  tests/**,\
  **/test_*.py,\
  **/*_test.py,\
  **/conftest.py

# Coverage exclusions (don't count test files in coverage)
sonar.coverage.exclusions=\
  tests/**,\
  scripts/**,\
  examples/**,\
  docs/**

# Duplication exclusions (similar test patterns are expected)
sonar.cpd.exclusions=\
  **/test_*.py,\
  **/*_test.py,\
  **/conftest.py,\
  **/agents/fluency_*.py

# =============================================================================
# Quality Gate
# =============================================================================
sonar.qualitygate.wait=true

# =============================================================================
# Issue Ignore Rules
# See: https://docs.sonarsource.com/sonarcloud/project-administration/narrowing-the-focus/
# =============================================================================
sonar.issue.ignore.multicriteria=e1,e2,e3,e4,e5,e6,e7,e8,e9,e10,e11,e12,e13

# --- S107: Too many parameters (threshold: 7) ---
# Agents, CLI commands, and complex modules legitimately need many parameters

# Ignore S107 in agents (complex domain logic)
sonar.issue.ignore.multicriteria.e1.ruleKey=python:S107
sonar.issue.ignore.multicriteria.e1.resourceKey=**/agents/**

# Ignore S107 in CLI (typer commands have many options)
sonar.issue.ignore.multicriteria.e2.ruleKey=python:S107
sonar.issue.ignore.multicriteria.e2.resourceKey=**/cli/**

# Ignore S107 in core modules
sonar.issue.ignore.multicriteria.e3.ruleKey=python:S107
sonar.issue.ignore.multicriteria.e3.resourceKey=**/core/**

# Ignore S107 in style modules
sonar.issue.ignore.multicriteria.e4.ruleKey=python:S107
sonar.issue.ignore.multicriteria.e4.resourceKey=**/style/**

# Ignore S107 in memory modules
sonar.issue.ignore.multicriteria.e5.ruleKey=python:S107
sonar.issue.ignore.multicriteria.e5.resourceKey=**/memory/**

# Ignore S107 in training modules
sonar.issue.ignore.multicriteria.e6.ruleKey=python:S107
sonar.issue.ignore.multicriteria.e6.resourceKey=**/training/**

# --- S3776: Cognitive Complexity (threshold: 15) ---
# Complex business logic in specific modules

# Ignore S3776 in CLI commands (complex by nature)
sonar.issue.ignore.multicriteria.e7.ruleKey=python:S3776
sonar.issue.ignore.multicriteria.e7.resourceKey=**/cli/commands/**

# Ignore S3776 in style analyzer (complex analysis logic)
sonar.issue.ignore.multicriteria.e8.ruleKey=python:S3776
sonar.issue.ignore.multicriteria.e8.resourceKey=**/style/**

# Ignore S3776 in agents (complex domain logic)
sonar.issue.ignore.multicriteria.e9.ruleKey=python:S3776
sonar.issue.ignore.multicriteria.e9.resourceKey=**/agents/**

# Ignore S3776 in core modules
sonar.issue.ignore.multicriteria.e10.ruleKey=python:S3776
sonar.issue.ignore.multicriteria.e10.resourceKey=**/core/**

# --- S1481: Unused local variables ---
# Sometimes needed for destructuring or clarity
sonar.issue.ignore.multicriteria.e11.ruleKey=python:S1481
sonar.issue.ignore.multicriteria.e11.resourceKey=**/cli/**

# --- S5720: Broad exception handling ---
# Graceful degradation pattern in our codebase
sonar.issue.ignore.multicriteria.e12.ruleKey=python:S5720
sonar.issue.ignore.multicriteria.e12.resourceKey=**/agents/**

# --- S1192: String literals should not be duplicated ---
# Error messages and prompts often repeat
sonar.issue.ignore.multicriteria.e13.ruleKey=python:S1192
sonar.issue.ignore.multicriteria.e13.resourceKey=**/agents/**
